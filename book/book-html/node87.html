<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">

<!--Converted with LaTeX2HTML 2002-2-1 (1.71)
original version by:  Nikos Drakos, CBLU, University of Leeds
* revised and updated by:  Marcus Hennecke, Ross Moore, Herb Swan
* with significant contributions from:
  Jens Lippmann, Marek Rouchal, Martin Wilck and others -->
<HTML>
<HEAD>
<TITLE>Phase modulation and FM</TITLE>
<META NAME="description" CONTENT="Phase modulation and FM">
<META NAME="keywords" CONTENT="book">
<META NAME="resource-type" CONTENT="document">
<META NAME="distribution" CONTENT="global">

<META NAME="Generator" CONTENT="LaTeX2HTML v2002-2-1">
<META HTTP-EQUIV="Content-Style-Type" CONTENT="text/css">

<LINK REL="STYLESHEET" HREF="book.css">

<LINK REL="previous" HREF="node86.html">
<LINK REL="up" HREF="node80.html">
<LINK REL="next" HREF="node88.html">
</HEAD>

<BODY >
<!--Navigation Panel-->
<A NAME="tex2html1842"
  HREF="node88.html">
<IMG WIDTH="37" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="next"
 SRC="file:/usr/local/share/lib/latex2html/icons/next.png"></A> 
<A NAME="tex2html1836"
  HREF="node80.html">
<IMG WIDTH="26" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="up"
 SRC="file:/usr/local/share/lib/latex2html/icons/up.png"></A> 
<A NAME="tex2html1832"
  HREF="node86.html">
<IMG WIDTH="63" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="previous"
 SRC="file:/usr/local/share/lib/latex2html/icons/prev.png"></A> 
<A NAME="tex2html1838"
  HREF="node4.html">
<IMG WIDTH="65" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="contents"
 SRC="file:/usr/local/share/lib/latex2html/icons/contents.png"></A> 
<A NAME="tex2html1840"
  HREF="node201.html">
<IMG WIDTH="43" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="index"
 SRC="file:/usr/local/share/lib/latex2html/icons/index.png"></A> 
<BR>
<B> Next:</B> <A NAME="tex2html1843"
  HREF="node88.html">Exercises</A>
<B> Up:</B> <A NAME="tex2html1837"
  HREF="node80.html">Examples</A>
<B> Previous:</B> <A NAME="tex2html1833"
  HREF="node86.html">Sinusoidal waveshaping: evenness and</A>
 &nbsp; <B>  <A NAME="tex2html1839"
  HREF="node4.html">Contents</A></B> 
 &nbsp; <B>  <A NAME="tex2html1841"
  HREF="node201.html">Index</A></B> 
<BR>
<BR>
<!--End of Navigation Panel-->

<H2><A NAME="SECTION00957000000000000000">
Phase modulation and FM</A>
</H2>
<A NAME="sect5.example.fm"></A>
<P>
Example E08.phase.mod.pd, shown in Figure <A HREF="#fig05.15">5.15</A>, shows how to use Pd to 
realize true frequency
modulation (part a) and phase modulation (part b).  These correspond to the
block diagrams of Figure <A HREF="node79.html#fig05.08">5.8</A>.  To
accomplish phase modulation, the carrier oscillator is split into its phase and
cosine lookup components.  The signal is of the form
<BR><P></P>
<DIV ALIGN="CENTER">
<!-- MATH
 \begin{displaymath}
x[t] = \cos( \omega_c n + a \cos(\omega_m n))
\end{displaymath}
 -->

<IMG
 WIDTH="198" HEIGHT="28" BORDER="0"
 SRC="img533.png"
 ALT="\begin{displaymath}
x[t] = \cos( \omega_c n + a \cos(\omega_m n))
\end{displaymath}">
</DIV>
<BR CLEAR="ALL">
<P></P>
where <IMG
 WIDTH="19" HEIGHT="29" ALIGN="MIDDLE" BORDER="0"
 SRC="img464.png"
 ALT="$\omega_c$"> is the carrier frequency, <IMG
 WIDTH="25" HEIGHT="29" ALIGN="MIDDLE" BORDER="0"
 SRC="img463.png"
 ALT="$\omega_m$"> is the modulation
frequency, and <IMG
 WIDTH="11" HEIGHT="13" ALIGN="BOTTOM" BORDER="0"
 SRC="img4.png"
 ALT="$a$"> is the index of modulation--all in angular units.

<P>

<DIV ALIGN="CENTER"><A NAME="fig05.15"></A><A NAME="5903"></A>
<TABLE>
<CAPTION ALIGN="BOTTOM"><STRONG>Figure 5.15:</STRONG>
Pd patches for: (a) frequency modulation; (b) phase modulation.</CAPTION>
<TR><TD><IMG
 WIDTH="480" HEIGHT="265" BORDER="0"
 SRC="img534.png"
 ALT="\begin{figure}\psfig{file=figs/fig05.15.ps}\end{figure}"></TD></TR>
</TABLE>
</DIV>

<P>
We can predict the spectrum by expanding the outer cosine:
<BR><P></P>
<DIV ALIGN="CENTER">
<!-- MATH
 \begin{displaymath}
x[t] = \cos( \omega_c n ) \cos (a \cos(\omega_m n))
    	 - \sin( \omega_c n ) \sin (a \cos(\omega_m n))
\end{displaymath}
 -->

<IMG
 WIDTH="403" HEIGHT="28" BORDER="0"
 SRC="img535.png"
 ALT="\begin{displaymath}
x[t] = \cos( \omega_c n ) \cos (a \cos(\omega_m n))
- \sin( \omega_c n ) \sin (a \cos(\omega_m n))
\end{displaymath}">
</DIV>
<BR CLEAR="ALL">
<P></P>
Plugging in the expansions from Page <A HREF="node86.html#sect5.bessel"><IMG  ALIGN="BOTTOM" BORDER="1" ALT="[*]"
 SRC="file:/usr/local/share/lib/latex2html/icons/crossref.png"></A> and simplifying
yields:
<BR><P></P>
<DIV ALIGN="CENTER">
<!-- MATH
 \begin{displaymath}
x[t] = {J_0}(a) \cos( \omega_c n )
\end{displaymath}
 -->

<IMG
 WIDTH="142" HEIGHT="28" BORDER="0"
 SRC="img536.png"
 ALT="\begin{displaymath}
x[t] = {J_0}(a) \cos( \omega_c n )
\end{displaymath}">
</DIV>
<BR CLEAR="ALL">
<P></P>
<BR><P></P>
<DIV ALIGN="CENTER">
<!-- MATH
 \begin{displaymath}
+ {J_1}(a) \cos( (\omega_c+\omega_m) n + {\pi\over2}) 
    + {J_1}(a) \cos( (\omega_c-\omega_m) n + {\pi\over2})
\end{displaymath}
 -->

<IMG
 WIDTH="401" HEIGHT="35" BORDER="0"
 SRC="img537.png"
 ALT="\begin{displaymath}
+ {J_1}(a) \cos( (\omega_c+\omega_m) n + {\pi\over2})
+ {J_1}(a) \cos( (\omega_c-\omega_m) n + {\pi\over2})
\end{displaymath}">
</DIV>
<BR CLEAR="ALL">
<P></P>
<BR><P></P>
<DIV ALIGN="CENTER">
<!-- MATH
 \begin{displaymath}
+ {J_2}(a) \cos( (\omega_c+2\omega_m) n + \pi) 
    + {J_2}(a) \cos( (\omega_c-2\omega_m) n + \pi)
\end{displaymath}
 -->

<IMG
 WIDTH="409" HEIGHT="28" BORDER="0"
 SRC="img538.png"
 ALT="\begin{displaymath}
+ {J_2}(a) \cos( (\omega_c+2\omega_m) n + \pi)
+ {J_2}(a) \cos( (\omega_c-2\omega_m) n + \pi)
\end{displaymath}">
</DIV>
<BR CLEAR="ALL">
<P></P>
<BR><P></P>
<DIV ALIGN="CENTER">
<!-- MATH
 \begin{displaymath}
+ {J_3}(a) \cos( (\omega_c+3\omega_m) n + {{3\pi}\over2}) 
    + {J_3}(a) \cos( (\omega_c-3\omega_m) n + {{3\pi}\over2}) 
    + \cdots
\end{displaymath}
 -->

<IMG
 WIDTH="471" HEIGHT="38" BORDER="0"
 SRC="img539.png"
 ALT="\begin{displaymath}
+ {J_3}(a) \cos( (\omega_c+3\omega_m) n + {{3\pi}\over2})
...
...}(a) \cos( (\omega_c-3\omega_m) n + {{3\pi}\over2})
+ \cdots
\end{displaymath}">
</DIV>
<BR CLEAR="ALL">
<P></P>
So the components are centered about the carrier frequency <IMG
 WIDTH="19" HEIGHT="29" ALIGN="MIDDLE" BORDER="0"
 SRC="img464.png"
 ALT="$\omega_c$"> with
sidebands extending in either direction, each spaced <IMG
 WIDTH="25" HEIGHT="29" ALIGN="MIDDLE" BORDER="0"
 SRC="img463.png"
 ALT="$\omega_m$"> from the
next.  The amplitudes are functions of the index of
modulation, and don't depend on the frequencies.
Figure <A HREF="#fig05.16">5.16</A> shows some two-operator phase modulation spectra,
measured using Example E09.FM.spectrum.pd.  

<P>

<DIV ALIGN="CENTER"><A NAME="fig05.16"></A><A NAME="5921"></A>
<TABLE>
<CAPTION ALIGN="BOTTOM"><STRONG>Figure 5.16:</STRONG>
Spectra from phase modulation at three different indices.  The indices
are given as multiples of <IMG
 WIDTH="21" HEIGHT="13" ALIGN="BOTTOM" BORDER="0"
 SRC="img16.png"
 ALT="$2\pi $"> radians.</CAPTION>
<TR><TD><IMG
 WIDTH="441" HEIGHT="438" BORDER="0"
 SRC="img540.png"
 ALT="\begin{figure}\psfig{file=figs/fig05.16.ps}\end{figure}"></TD></TR>
</TABLE>
</DIV>

<P>
Phase modulation can thus be seen simply as a form of ring modulated 
waveshaping.  So
we can use the
strategies described in Section <A HREF="node77.html#sect5.ringmod">5.2</A> to generate particular
combinations of frequencies.  For example, if the carrier frequency is
half the modulation frequency, you get a sound with odd harmonics exactly
as in the octave dividing example (Figure <A HREF="node82.html#fig05.10">5.10</A>).

<P>
Frequency modulation need not be restricted to purely sinusoidal carrier or
modulation oscillators.  One well-trodden path is to effect phase modulation
on the phase modulation spectrum itself.  There are then two indices of
modulation (call
them <IMG
 WIDTH="11" HEIGHT="13" ALIGN="BOTTOM" BORDER="0"
 SRC="img4.png"
 ALT="$a$"> and <IMG
 WIDTH="10" HEIGHT="14" ALIGN="BOTTOM" BORDER="0"
 SRC="img21.png"
 ALT="$b$">) and two frequencies of modulation (<IMG
 WIDTH="25" HEIGHT="29" ALIGN="MIDDLE" BORDER="0"
 SRC="img463.png"
 ALT="$\omega_m$"> and <IMG
 WIDTH="20" HEIGHT="29" ALIGN="MIDDLE" BORDER="0"
 SRC="img541.png"
 ALT="$\omega_p$">)
and the waveform is:
<BR><P></P>
<DIV ALIGN="CENTER">
<!-- MATH
 \begin{displaymath}
x[n] = \cos(\omega_c n + a \cos(\omega_m n) + b \cos(\omega_p n))
\end{displaymath}
 -->

<IMG
 WIDTH="291" HEIGHT="29" BORDER="0"
 SRC="img542.png"
 ALT="\begin{displaymath}
x[n] = \cos(\omega_c n + a \cos(\omega_m n) + b \cos(\omega_p n))
\end{displaymath}">
</DIV>
<BR CLEAR="ALL">
<P></P>
To analyze the result, just rewrite the original FM series above, replacing
<IMG
 WIDTH="29" HEIGHT="29" ALIGN="MIDDLE" BORDER="0"
 SRC="img543.png"
 ALT="$\omega_c n$"> everywhere with <!-- MATH
 $\omega_c n +  b \cos(\omega_p n)$
 -->
<IMG
 WIDTH="118" HEIGHT="32" ALIGN="MIDDLE" BORDER="0"
 SRC="img544.png"
 ALT="$\omega_c n + b \cos(\omega_p n)$">.  The third
positive sideband becomes for instance:
<BR><P></P>
<DIV ALIGN="CENTER">
<!-- MATH
 \begin{displaymath}
{J_3}(a) \cos( (\omega_c+3\omega_m) n + {{3\pi}\over2} + b \cos(\omega_p n))
\end{displaymath}
 -->

<IMG
 WIDTH="289" HEIGHT="38" BORDER="0"
 SRC="img545.png"
 ALT="\begin{displaymath}
{J_3}(a) \cos( (\omega_c+3\omega_m) n + {{3\pi}\over2} + b \cos(\omega_p n))
\end{displaymath}">
</DIV>
<BR CLEAR="ALL">
<P></P>
This is itself just another FM spectrum, with its own sidebands of frequency
<BR><P></P>
<DIV ALIGN="CENTER">
<!-- MATH
 \begin{displaymath}
\omega_c+3\omega_m + k \omega_p , k = 0, \pm 1, \pm 2, \ldots
\end{displaymath}
 -->

<IMG
 WIDTH="236" HEIGHT="29" BORDER="0"
 SRC="img546.png"
 ALT="\begin{displaymath}
\omega_c+3\omega_m + k \omega_p , k = 0, \pm 1, \pm 2, \ldots
\end{displaymath}">
</DIV>
<BR CLEAR="ALL">
<P></P>
having amplitude <!-- MATH
 ${J_3}(a) {J_k}(b)$
 -->
<IMG
 WIDTH="76" HEIGHT="32" ALIGN="MIDDLE" BORDER="0"
 SRC="img547.png"
 ALT="${J_3}(a) {J_k}(b)$"> and phase <IMG
 WIDTH="77" HEIGHT="32" ALIGN="MIDDLE" BORDER="0"
 SRC="img548.png"
 ALT="$(3+k)\pi / 2$">
[<A
 HREF="node202.html#r-lebrun77">Leb77</A>].  Example E10.complex.FM.pd (not shown here) illustrates this by
graphing spectra from a two-modulator FM instrument. 

<P>
Since early times [<A
 HREF="node202.html#r-schottstaedt87">Sch77</A>] researchers have sought combinations
of phases, frequencies, and modulation indices, for simple and compact phase
modulation instruments, that manage to imitate familiar instrumental sounds.
This became a major industry with the introduction of commercial FM
synthesizers.

<P>
<HR>
<!--Navigation Panel-->
<A NAME="tex2html1842"
  HREF="node88.html">
<IMG WIDTH="37" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="next"
 SRC="file:/usr/local/share/lib/latex2html/icons/next.png"></A> 
<A NAME="tex2html1836"
  HREF="node80.html">
<IMG WIDTH="26" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="up"
 SRC="file:/usr/local/share/lib/latex2html/icons/up.png"></A> 
<A NAME="tex2html1832"
  HREF="node86.html">
<IMG WIDTH="63" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="previous"
 SRC="file:/usr/local/share/lib/latex2html/icons/prev.png"></A> 
<A NAME="tex2html1838"
  HREF="node4.html">
<IMG WIDTH="65" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="contents"
 SRC="file:/usr/local/share/lib/latex2html/icons/contents.png"></A> 
<A NAME="tex2html1840"
  HREF="node201.html">
<IMG WIDTH="43" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="index"
 SRC="file:/usr/local/share/lib/latex2html/icons/index.png"></A> 
<BR>
<B> Next:</B> <A NAME="tex2html1843"
  HREF="node88.html">Exercises</A>
<B> Up:</B> <A NAME="tex2html1837"
  HREF="node80.html">Examples</A>
<B> Previous:</B> <A NAME="tex2html1833"
  HREF="node86.html">Sinusoidal waveshaping: evenness and</A>
 &nbsp; <B>  <A NAME="tex2html1839"
  HREF="node4.html">Contents</A></B> 
 &nbsp; <B>  <A NAME="tex2html1841"
  HREF="node201.html">Index</A></B> 
<!--End of Navigation Panel-->
<ADDRESS>
Miller Puckette
2006-12-30
</ADDRESS>
</BODY>
</HTML>
