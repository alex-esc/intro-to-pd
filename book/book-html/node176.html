<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">

<!--Converted with LaTeX2HTML 2002-2-1 (1.71)
original version by:  Nikos Drakos, CBLU, University of Leeds
* revised and updated by:  Marcus Hennecke, Ross Moore, Herb Swan
* with significant contributions from:
  Jens Lippmann, Marek Rouchal, Martin Wilck and others -->
<HTML>
<HEAD>
<TITLE>Phase relationships between channels</TITLE>
<META NAME="description" CONTENT="Phase relationships between channels">
<META NAME="keywords" CONTENT="book">
<META NAME="resource-type" CONTENT="document">
<META NAME="distribution" CONTENT="global">

<META NAME="Generator" CONTENT="LaTeX2HTML v2002-2-1">
<META HTTP-EQUIV="Content-Style-Type" CONTENT="text/css">

<LINK REL="STYLESHEET" HREF="book.css">

<LINK REL="previous" HREF="node175.html">
<LINK REL="up" HREF="node175.html">
<LINK REL="next" HREF="node177.html">
</HEAD>

<BODY >
<!--Navigation Panel-->
<A NAME="tex2html3199"
  HREF="node177.html">
<IMG WIDTH="37" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="next"
 SRC="file:/usr/local/share/lib/latex2html/icons/next.png"></A> 
<A NAME="tex2html3193"
  HREF="node175.html">
<IMG WIDTH="26" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="up"
 SRC="file:/usr/local/share/lib/latex2html/icons/up.png"></A> 
<A NAME="tex2html3189"
  HREF="node175.html">
<IMG WIDTH="63" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="previous"
 SRC="file:/usr/local/share/lib/latex2html/icons/prev.png"></A> 
<A NAME="tex2html3195"
  HREF="node4.html">
<IMG WIDTH="65" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="contents"
 SRC="file:/usr/local/share/lib/latex2html/icons/contents.png"></A> 
<A NAME="tex2html3197"
  HREF="node201.html">
<IMG WIDTH="43" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="index"
 SRC="file:/usr/local/share/lib/latex2html/icons/index.png"></A> 
<BR>
<B> Next:</B> <A NAME="tex2html3200"
  HREF="node177.html">Phase bashing</A>
<B> Up:</B> <A NAME="tex2html3194"
  HREF="node175.html">Phase</A>
<B> Previous:</B> <A NAME="tex2html3190"
  HREF="node175.html">Phase</A>
 &nbsp; <B>  <A NAME="tex2html3196"
  HREF="node4.html">Contents</A></B> 
 &nbsp; <B>  <A NAME="tex2html3198"
  HREF="node201.html">Index</A></B> 
<BR>
<BR>
<!--End of Navigation Panel-->

<H2><A NAME="SECTION001351000000000000000"></A>
<A NAME="sect9.phaserelationship"></A>
<BR>
Phase relationships between channels
</H2>

<P>
In the scheme above, the phase of each <IMG
 WIDTH="52" HEIGHT="32" ALIGN="MIDDLE" BORDER="0"
 SRC="img64.png"
 ALT="$S[m, k]$"> depends only on the previous
value for the same
channel.  The phase relationships between neighboring channels are left to
chance.  This sometimes works fine, but sometimes the incoherence
of neighboring channels gives rise to an unintended chorus effect.  We
would ideally wish for  <IMG
 WIDTH="52" HEIGHT="32" ALIGN="MIDDLE" BORDER="0"
 SRC="img64.png"
 ALT="$S[m, k]$"> and <IMG
 WIDTH="80" HEIGHT="32" ALIGN="MIDDLE" BORDER="0"
 SRC="img1195.png"
 ALT="$S[m,k+1]$"> to have the same phase
relationship as for <IMG
 WIDTH="37" HEIGHT="32" ALIGN="MIDDLE" BORDER="0"
 SRC="img1196.png"
 ALT="$T'[k]$"> and  <IMG
 WIDTH="64" HEIGHT="32" ALIGN="MIDDLE" BORDER="0"
 SRC="img1197.png"
 ALT="$T'[k+1]$">, but also for the phase relationship
between <IMG
 WIDTH="52" HEIGHT="32" ALIGN="MIDDLE" BORDER="0"
 SRC="img64.png"
 ALT="$S[m, k]$"> and <IMG
 WIDTH="80" HEIGHT="32" ALIGN="MIDDLE" BORDER="0"
 SRC="img1198.png"
 ALT="$S[m-1,k]$"> to be the same as between <IMG
 WIDTH="37" HEIGHT="32" ALIGN="MIDDLE" BORDER="0"
 SRC="img1196.png"
 ALT="$T'[k]$"> and <IMG
 WIDTH="32" HEIGHT="32" ALIGN="MIDDLE" BORDER="0"
 SRC="img1199.png"
 ALT="$T[k]$">.

<P>
These <IMG
 WIDTH="26" HEIGHT="14" ALIGN="BOTTOM" BORDER="0"
 SRC="img1200.png"
 ALT="$2N$"> equations for <IMG
 WIDTH="18" HEIGHT="14" ALIGN="BOTTOM" BORDER="0"
 SRC="img3.png"
 ALT="$N$"> phases in general will have no solution, but we
can alter the equation for <IMG
 WIDTH="52" HEIGHT="32" ALIGN="MIDDLE" BORDER="0"
 SRC="img64.png"
 ALT="$S[m, k]$"> above so that whenever there happens to be
a solution to the over-constrained system of equations, the reconstruction
algorithm homes in on the solution.  This approach is called
<A NAME="12657"></A><I>phase locking</I>
[<A
 HREF="node202.html#r-puckette95b">Puc95b</A>], and has the virtue of simplicity although more
sophisticated techniques are available [<A
 HREF="node202.html#r-dolson97">DL97</A>]).

<P>
The desired output phase relation, at the frame <IMG
 WIDTH="44" HEIGHT="29" ALIGN="MIDDLE" BORDER="0"
 SRC="img1185.png"
 ALT="$m-1$">, is:
<BR><P></P>
<DIV ALIGN="CENTER">
<!-- MATH
 \begin{displaymath}
\angle T[k+1] - \angle T[k] = \angle S[m-1, k+1] - \angle S[m-1, k]
\end{displaymath}
 -->

<IMG
 WIDTH="364" HEIGHT="28" BORDER="0"
 SRC="img1201.png"
 ALT="\begin{displaymath}
\angle T[k+1] - \angle T[k] = \angle S[m-1, k+1] - \angle S[m-1, k]
\end{displaymath}">
</DIV>
<BR CLEAR="ALL">
<P></P>
or, rearranging:
<BR><P></P>
<DIV ALIGN="CENTER">
<!-- MATH
 \begin{displaymath}
\angle \left \{ {{S[m-1, k+1]} \over {T[k+1]}} \right \} =
    \angle \left \{ {{S[m-1, k]} \over {T[k]}} \right \}
\end{displaymath}
 -->

<IMG
 WIDTH="279" HEIGHT="45" BORDER="0"
 SRC="img1202.png"
 ALT="\begin{displaymath}
\angle \left \{ {{S[m-1, k+1]} \over {T[k+1]}} \right \} =
\angle \left \{ {{S[m-1, k]} \over {T[k]}} \right \}
\end{displaymath}">
</DIV>
<BR CLEAR="ALL">
<P></P>
In other words, the phase of the quotient <IMG
 WIDTH="32" HEIGHT="32" ALIGN="MIDDLE" BORDER="0"
 SRC="img1203.png"
 ALT="$S/T$"> should not depend on <IMG
 WIDTH="12" HEIGHT="14" ALIGN="BOTTOM" BORDER="0"
 SRC="img58.png"
 ALT="$k$">.
With this in mind, we can rewrite the recursion formula for <IMG
 WIDTH="52" HEIGHT="32" ALIGN="MIDDLE" BORDER="0"
 SRC="img64.png"
 ALT="$S[m, k]$">:
<BR><P></P>
<DIV ALIGN="CENTER">
<!-- MATH
 \begin{displaymath}
S[m, k] \; = \; 
    {
        {  \left | 
            R[k]
        \right |}
        ^
        {-1}
    }
    \cdot
    {
        {R[k] T'[k]}
    }
\end{displaymath}
 -->

<IMG
 WIDTH="208" HEIGHT="28" BORDER="0"
 SRC="img1204.png"
 ALT="\begin{displaymath}
S[m, k] \; = \;
{
{ \left \vert
R[k]
\right \vert}
^
{-1}
}
\cdot
{
{R[k] T'[k]}
}
\end{displaymath}">
</DIV>
<BR CLEAR="ALL">
<P></P>
with
<BR><P></P>
<DIV ALIGN="CENTER">
<!-- MATH
 \begin{displaymath}
R[k] \; = \; 
    {
        {
            \overline {T[k]}  \; \cdot \; {S[m-1, k]}
        } \over {
            \left | 
                {S[m-1, k]}
            \right |
        }
    }
\end{displaymath}
 -->

<IMG
 WIDTH="188" HEIGHT="47" BORDER="0"
 SRC="img1205.png"
 ALT="\begin{displaymath}
R[k] \; = \;
{
{
\overline {T[k]} \; \cdot \; {S[m-1, k]}
} \over {
\left \vert
{S[m-1, k]}
\right \vert
}
}
\end{displaymath}">
</DIV>
<BR CLEAR="ALL">
<P></P>
and because of the previous equation, the <IMG
 WIDTH="33" HEIGHT="32" ALIGN="MIDDLE" BORDER="0"
 SRC="img1206.png"
 ALT="$R[k]$"> should all be in phase.  The
trick is now to replace <IMG
 WIDTH="33" HEIGHT="32" ALIGN="MIDDLE" BORDER="0"
 SRC="img1206.png"
 ALT="$R[k]$">
for each <IMG
 WIDTH="12" HEIGHT="14" ALIGN="BOTTOM" BORDER="0"
 SRC="img58.png"
 ALT="$k$"> with the sum of three neighboring ones.  The computation is then:
<BR><P></P>
<DIV ALIGN="CENTER">
<!-- MATH
 \begin{displaymath}
S[m, k] \; = \; 
    {
        {  \left | 
            R'[k]
        \right |}
        ^
        {-1}
    }
    \; \cdot \;
    {
        {R'[k] T'[k]}
    }
\end{displaymath}
 -->

<IMG
 WIDTH="226" HEIGHT="28" BORDER="0"
 SRC="img1207.png"
 ALT="\begin{displaymath}
S[m, k] \; = \;
{
{ \left \vert
R'[k]
\right \vert}
^
{-1}
}
\; \cdot \;
{
{R'[k] T'[k]}
}
\end{displaymath}">
</DIV>
<BR CLEAR="ALL">
<P></P>
with
<BR><P></P>
<DIV ALIGN="CENTER">
<!-- MATH
 \begin{displaymath}
R'[k] = R[k+1] + R[k] + R[k-1]
\end{displaymath}
 -->

<IMG
 WIDTH="238" HEIGHT="28" BORDER="0"
 SRC="img1208.png"
 ALT="\begin{displaymath}
R'[k] = R[k+1] + R[k] + R[k-1]
\end{displaymath}">
</DIV>
<BR CLEAR="ALL">
<P></P>
If the channels are already in the correct phase relationship, this has
no effect (the resulting phase will be the same as if only <IMG
 WIDTH="33" HEIGHT="32" ALIGN="MIDDLE" BORDER="0"
 SRC="img1206.png"
 ALT="$R[k]$"> were
used.)  But in general the sum will share two terms in common with its
neighbor at <IMG
 WIDTH="39" HEIGHT="30" ALIGN="MIDDLE" BORDER="0"
 SRC="img602.png"
 ALT="$k+1$">:
<BR><P></P>
<DIV ALIGN="CENTER">
<!-- MATH
 \begin{displaymath}
R'[k+1] = R[k+2] + R[k+1] + R[k]
\end{displaymath}
 -->

<IMG
 WIDTH="265" HEIGHT="28" BORDER="0"
 SRC="img1209.png"
 ALT="\begin{displaymath}
R'[k+1] = R[k+2] + R[k+1] + R[k]
\end{displaymath}">
</DIV>
<BR CLEAR="ALL">
<P></P>
so that the <IMG
 WIDTH="20" HEIGHT="15" ALIGN="BOTTOM" BORDER="0"
 SRC="img1210.png"
 ALT="$R'$"> will tend to point more in the same direction than the <IMG
 WIDTH="15" HEIGHT="14" ALIGN="BOTTOM" BORDER="0"
 SRC="img36.png"
 ALT="$R$">
do.   Applying this iteratively will eventually line all the <IMG
 WIDTH="20" HEIGHT="15" ALIGN="BOTTOM" BORDER="0"
 SRC="img1210.png"
 ALT="$R'$"> up to the
same phase, as long as the phase relationships between the measured spectra
<IMG
 WIDTH="15" HEIGHT="14" ALIGN="BOTTOM" BORDER="0"
 SRC="img557.png"
 ALT="$T$"> and <IMG
 WIDTH="19" HEIGHT="15" ALIGN="BOTTOM" BORDER="0"
 SRC="img1211.png"
 ALT="$T'$"> allow it.

<P>
<HR>
<!--Navigation Panel-->
<A NAME="tex2html3199"
  HREF="node177.html">
<IMG WIDTH="37" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="next"
 SRC="file:/usr/local/share/lib/latex2html/icons/next.png"></A> 
<A NAME="tex2html3193"
  HREF="node175.html">
<IMG WIDTH="26" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="up"
 SRC="file:/usr/local/share/lib/latex2html/icons/up.png"></A> 
<A NAME="tex2html3189"
  HREF="node175.html">
<IMG WIDTH="63" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="previous"
 SRC="file:/usr/local/share/lib/latex2html/icons/prev.png"></A> 
<A NAME="tex2html3195"
  HREF="node4.html">
<IMG WIDTH="65" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="contents"
 SRC="file:/usr/local/share/lib/latex2html/icons/contents.png"></A> 
<A NAME="tex2html3197"
  HREF="node201.html">
<IMG WIDTH="43" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="index"
 SRC="file:/usr/local/share/lib/latex2html/icons/index.png"></A> 
<BR>
<B> Next:</B> <A NAME="tex2html3200"
  HREF="node177.html">Phase bashing</A>
<B> Up:</B> <A NAME="tex2html3194"
  HREF="node175.html">Phase</A>
<B> Previous:</B> <A NAME="tex2html3190"
  HREF="node175.html">Phase</A>
 &nbsp; <B>  <A NAME="tex2html3196"
  HREF="node4.html">Contents</A></B> 
 &nbsp; <B>  <A NAME="tex2html3198"
  HREF="node201.html">Index</A></B> 
<!--End of Navigation Panel-->
<ADDRESS>
Miller Puckette
2006-12-30
</ADDRESS>
</BODY>
</HTML>
