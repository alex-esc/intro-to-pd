<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">

<!--Converted with LaTeX2HTML 2002-2-1 (1.71)
original version by:  Nikos Drakos, CBLU, University of Leeds
* revised and updated by:  Marcus Hennecke, Ross Moore, Herb Swan
* with significant contributions from:
  Jens Lippmann, Marek Rouchal, Martin Wilck and others -->
<HTML>
<HEAD>
<TITLE>Frequency and phase modulation</TITLE>
<META NAME="description" CONTENT="Frequency and phase modulation">
<META NAME="keywords" CONTENT="book">
<META NAME="resource-type" CONTENT="document">
<META NAME="distribution" CONTENT="global">

<META NAME="Generator" CONTENT="LaTeX2HTML v2002-2-1">
<META HTTP-EQUIV="Content-Style-Type" CONTENT="text/css">

<LINK REL="STYLESHEET" HREF="book.css">

<LINK REL="next" HREF="node80.html">
<LINK REL="previous" HREF="node78.html">
<LINK REL="up" HREF="node75.html">
<LINK REL="next" HREF="node80.html">
</HEAD>

<BODY >
<!--Navigation Panel-->
<A NAME="tex2html1725"
  HREF="node80.html">
<IMG WIDTH="37" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="next"
 SRC="file:/usr/local/share/lib/latex2html/icons/next.png"></A> 
<A NAME="tex2html1719"
  HREF="node75.html">
<IMG WIDTH="26" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="up"
 SRC="file:/usr/local/share/lib/latex2html/icons/up.png"></A> 
<A NAME="tex2html1713"
  HREF="node78.html">
<IMG WIDTH="63" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="previous"
 SRC="file:/usr/local/share/lib/latex2html/icons/prev.png"></A> 
<A NAME="tex2html1721"
  HREF="node4.html">
<IMG WIDTH="65" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="contents"
 SRC="file:/usr/local/share/lib/latex2html/icons/contents.png"></A> 
<A NAME="tex2html1723"
  HREF="node201.html">
<IMG WIDTH="43" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="index"
 SRC="file:/usr/local/share/lib/latex2html/icons/index.png"></A> 
<BR>
<B> Next:</B> <A NAME="tex2html1726"
  HREF="node80.html">Examples</A>
<B> Up:</B> <A NAME="tex2html1720"
  HREF="node75.html">Modulation</A>
<B> Previous:</B> <A NAME="tex2html1714"
  HREF="node78.html">Waveshaping</A>
 &nbsp; <B>  <A NAME="tex2html1722"
  HREF="node4.html">Contents</A></B> 
 &nbsp; <B>  <A NAME="tex2html1724"
  HREF="node201.html">Index</A></B> 
<BR>
<BR>
<!--End of Navigation Panel-->

<H1><A NAME="SECTION00940000000000000000"></A>
<A NAME="sect5.FM"></A>
<BR>
Frequency and phase modulation
</H1>

<P>
If a sinusoid is given a frequency which varies slowly in time we hear it as
having a varying pitch.  But if the pitch changes so quickly that our ears
can't track the change--for instance, if the change itself occurs at or
above the fundamental frequency of the sinusoid--we hear a timbral change.
The timbres so generated are rich and widely varying.  The discovery by 
John Chowning of this
possibility [<A
 HREF="node202.html#r-chowning73">Cho73</A>] revolutionized the field of computer music.
Here we develop 
<A NAME="5762"></A><A NAME="5763"></A><I>frequency modulation</I>,
usually called <I>FM</I>,
as a special case of waveshaping [<A
 HREF="node202.html#r-lebrun79">Leb79</A>]
[<A
 HREF="node202.html#r-dodge85">DJ85</A>, pp.155-158]; the
analysis given here is somewhat different [<A
 HREF="node202.html#r-puckette01a">Puc01</A>].

<P>
The FM technique, in its simplest form, is shown in Figure <A HREF="#fig05.08">5.8</A>
(part a).
A frequency-modulated sinusoid is one whose frequency varies sinusoidally, at
some angular frequency <IMG
 WIDTH="25" HEIGHT="29" ALIGN="MIDDLE" BORDER="0"
 SRC="img463.png"
 ALT="$\omega_m$">, about a central frequency <IMG
 WIDTH="19" HEIGHT="29" ALIGN="MIDDLE" BORDER="0"
 SRC="img464.png"
 ALT="$\omega_c$">, so
that the instantaneous frequencies vary between <IMG
 WIDTH="67" HEIGHT="32" ALIGN="MIDDLE" BORDER="0"
 SRC="img465.png"
 ALT="$(1-r)\omega_c $"> and
<!-- MATH
 $(1+r) \omega_c$
 -->
<IMG
 WIDTH="67" HEIGHT="32" ALIGN="MIDDLE" BORDER="0"
 SRC="img466.png"
 ALT="$(1+r) \omega_c$">, with parameters <IMG
 WIDTH="25" HEIGHT="29" ALIGN="MIDDLE" BORDER="0"
 SRC="img463.png"
 ALT="$\omega_m$"> controlling the frequency of
variation, and <IMG
 WIDTH="11" HEIGHT="13" ALIGN="BOTTOM" BORDER="0"
 SRC="img467.png"
 ALT="$r$"> controlling the depth of variation.  The parameters 
<IMG
 WIDTH="19" HEIGHT="29" ALIGN="MIDDLE" BORDER="0"
 SRC="img464.png"
 ALT="$\omega_c$">, <IMG
 WIDTH="25" HEIGHT="29" ALIGN="MIDDLE" BORDER="0"
 SRC="img463.png"
 ALT="$\omega_m$">, and <IMG
 WIDTH="11" HEIGHT="13" ALIGN="BOTTOM" BORDER="0"
 SRC="img467.png"
 ALT="$r$"> are called the
<A NAME="5770"></A><A NAME="5771"></A><I>carrier frequency</I>, the
<A NAME="5773"></A><I>modulation frequency</I>, and the
<A NAME="5775"></A><I>index of modulation</I>, respectively.

<P>
It is customary to use a simpler, essentially equivalent formulation in
which the phase, instead of the frequency, of the carrier sinusoid is
modulated sinusoidally.  (This gives an equivalent result since the
instantaneous frequency is the rate of change of phase, and since the
rate of change of a sinusoid is just another sinusoid.)  The
phase modulation formulation is shown in part (b) of the figure.

<P>
We can analyze the result of phase modulation as follows, assuming that
the modulating oscillator and the wavetable are both sinusoidal, and that
the carrier and modulation frequencies don't themselves vary
in time.  The resulting signal can then be written as
<BR><P></P>
<DIV ALIGN="CENTER">
<!-- MATH
 \begin{displaymath}
x[n] = \cos(a \cos(\omega_m  n) + \omega_c  n )
\end{displaymath}
 -->

<IMG
 WIDTH="202" HEIGHT="28" BORDER="0"
 SRC="img468.png"
 ALT="\begin{displaymath}
x[n] = \cos(a \cos(\omega_m n) + \omega_c n )
\end{displaymath}">
</DIV>
<BR CLEAR="ALL">
<P></P>
The
parameter <IMG
 WIDTH="11" HEIGHT="13" ALIGN="BOTTOM" BORDER="0"
 SRC="img4.png"
 ALT="$a$">, which takes the place of the earlier parameter <IMG
 WIDTH="11" HEIGHT="13" ALIGN="BOTTOM" BORDER="0"
 SRC="img467.png"
 ALT="$r$">, is 
likewise called the index of modulation; it too 
controls the extent of frequency variation relative to the carrier frequency
<IMG
 WIDTH="19" HEIGHT="29" ALIGN="MIDDLE" BORDER="0"
 SRC="img464.png"
 ALT="$\omega_c$">.  If <IMG
 WIDTH="41" HEIGHT="13" ALIGN="BOTTOM" BORDER="0"
 SRC="img469.png"
 ALT="$a=0$">, there
is no frequency variation and the expression reduces to the unmodified,
carrier sinusoid; as <IMG
 WIDTH="11" HEIGHT="13" ALIGN="BOTTOM" BORDER="0"
 SRC="img4.png"
 ALT="$a$"> increases the waveform becomes more complex.

<P>

<DIV ALIGN="CENTER"><A NAME="fig05.08"></A><A NAME="5779"></A>
<TABLE>
<CAPTION ALIGN="BOTTOM"><STRONG>Figure 5.8:</STRONG>
Block diagram for frequency modulation (FM) synthesis: (a) the classic
form; (b) realized as phase modulation.</CAPTION>
<TR><TD><IMG
 WIDTH="507" HEIGHT="499" BORDER="0"
 SRC="img470.png"
 ALT="\begin{figure}\psfig{file=figs/fig05.08.ps}\end{figure}"></TD></TR>
</TABLE>
</DIV>

<P>
To analyse the resulting spectrum we can rewrite the signal as,
<BR><P></P>
<DIV ALIGN="CENTER">
<!-- MATH
 \begin{displaymath}
x[n] = \cos(\omega_c n) * \cos(a \cos(\omega_m n))
\end{displaymath}
 -->

<IMG
 WIDTH="231" HEIGHT="28" BORDER="0"
 SRC="img471.png"
 ALT="\begin{displaymath}
x[n] = \cos(\omega_c n) * \cos(a \cos(\omega_m n))
\end{displaymath}">
</DIV>
<BR CLEAR="ALL">
<P></P>
<BR><P></P>
<DIV ALIGN="CENTER">
<!-- MATH
 \begin{displaymath}
- \sin(\omega_c n) * \sin(a \cos(\omega_m n))
\end{displaymath}
 -->

<IMG
 WIDTH="194" HEIGHT="28" BORDER="0"
 SRC="img472.png"
 ALT="\begin{displaymath}
- \sin(\omega_c n) * \sin(a \cos(\omega_m n))
\end{displaymath}">
</DIV>
<BR CLEAR="ALL">
<P></P>
We can consider the result as a sum of two waveshaping
generators, each operating on a sinusoid of frequency <IMG
 WIDTH="25" HEIGHT="29" ALIGN="MIDDLE" BORDER="0"
 SRC="img463.png"
 ALT="$\omega_m$"> and
with a waveshaping index <IMG
 WIDTH="11" HEIGHT="13" ALIGN="BOTTOM" BORDER="0"
 SRC="img4.png"
 ALT="$a$">, and each ring modulated with a sinusoid of
frequency <IMG
 WIDTH="19" HEIGHT="29" ALIGN="MIDDLE" BORDER="0"
 SRC="img464.png"
 ALT="$\omega_c$">.  The waveshaping function <IMG
 WIDTH="13" HEIGHT="30" ALIGN="MIDDLE" BORDER="0"
 SRC="img112.png"
 ALT="$f$"> is given by
<!-- MATH
 $f(x) = \cos(x)$
 -->
<IMG
 WIDTH="98" HEIGHT="32" ALIGN="MIDDLE" BORDER="0"
 SRC="img473.png"
 ALT="$f(x) = \cos(x)$"> for the first term and by <!-- MATH
 $f(x) = \sin(x)$
 -->
<IMG
 WIDTH="96" HEIGHT="32" ALIGN="MIDDLE" BORDER="0"
 SRC="img474.png"
 ALT="$f(x) = \sin(x)$"> for the second.

<P>
Returning to Figure <A HREF="node77.html#fig05.04">5.4</A>, we can predict what the
spectrum will look like.  The two harmonic spectra, of the waveshaping outputs
<BR><P></P>
<DIV ALIGN="CENTER">
<!-- MATH
 \begin{displaymath}
\cos(a \cos(\omega_m n))
\end{displaymath}
 -->

<IMG
 WIDTH="108" HEIGHT="28" BORDER="0"
 SRC="img475.png"
 ALT="\begin{displaymath}
\cos(a \cos(\omega_m n))
\end{displaymath}">
</DIV>
<BR CLEAR="ALL">
<P></P>
and
<BR><P></P>
<DIV ALIGN="CENTER">
<!-- MATH
 \begin{displaymath}
\sin(a \cos(\omega_m n))
\end{displaymath}
 -->

<IMG
 WIDTH="107" HEIGHT="28" BORDER="0"
 SRC="img476.png"
 ALT="\begin{displaymath}
\sin(a \cos(\omega_m n))
\end{displaymath}">
</DIV>
<BR CLEAR="ALL">
<P></P>
have, respectively, harmonics tuned to
<BR><P></P>
<DIV ALIGN="CENTER">
<!-- MATH
 \begin{displaymath}
0, 2\omega_m, 4\omega_m, \ldots
\end{displaymath}
 -->

<IMG
 WIDTH="105" HEIGHT="27" BORDER="0"
 SRC="img477.png"
 ALT="\begin{displaymath}
0, 2\omega_m, 4\omega_m, \ldots
\end{displaymath}">
</DIV>
<BR CLEAR="ALL">
<P></P>
and
<BR><P></P>
<DIV ALIGN="CENTER">
<!-- MATH
 \begin{displaymath}
\omega_m, 3\omega_m, 5\omega_m, \ldots
\end{displaymath}
 -->

<IMG
 WIDTH="120" HEIGHT="27" BORDER="0"
 SRC="img478.png"
 ALT="\begin{displaymath}
\omega_m, 3\omega_m, 5\omega_m, \ldots
\end{displaymath}">
</DIV>
<BR CLEAR="ALL">
<P></P>
and each is multiplied by a sinusoid at the carrier frequency.  So there
will be a spectrum centered at the carrier frequency <IMG
 WIDTH="19" HEIGHT="29" ALIGN="MIDDLE" BORDER="0"
 SRC="img464.png"
 ALT="$\omega_c$">, with
sidebands at both even and odd multiples of the modulation frequency <IMG
 WIDTH="25" HEIGHT="29" ALIGN="MIDDLE" BORDER="0"
 SRC="img463.png"
 ALT="$\omega_m$">,
contributed respectively by the sine and cosine waveshaping terms above.
The index of modulation <IMG
 WIDTH="11" HEIGHT="13" ALIGN="BOTTOM" BORDER="0"
 SRC="img4.png"
 ALT="$a$">, as it changes, controls the relative strength of
the various partials.  The partials themselves are situated at the frequencies
<BR><P></P>
<DIV ALIGN="CENTER">
<!-- MATH
 \begin{displaymath}
\omega_c + m \omega_m
\end{displaymath}
 -->

<IMG
 WIDTH="71" HEIGHT="26" BORDER="0"
 SRC="img479.png"
 ALT="\begin{displaymath}
\omega_c + m \omega_m
\end{displaymath}">
</DIV>
<BR CLEAR="ALL">
<P></P>
where
<BR><P></P>
<DIV ALIGN="CENTER">
<!-- MATH
 \begin{displaymath}
m = \ldots -2, -1, 0, 1, 2, \ldots
\end{displaymath}
 -->

<IMG
 WIDTH="178" HEIGHT="27" BORDER="0"
 SRC="img480.png"
 ALT="\begin{displaymath}
m = \ldots -2, -1, 0, 1, 2, \ldots
\end{displaymath}">
</DIV>
<BR CLEAR="ALL">
<P></P>
As with any situation where two periodic signals are multiplied, if there is
some common supermultiple of the two periods, the resulting product will repeat
at that longer period.  So if the two periods are <IMG
 WIDTH="21" HEIGHT="14" ALIGN="BOTTOM" BORDER="0"
 SRC="img481.png"
 ALT="$k \tau$"> and <IMG
 WIDTH="26" HEIGHT="13" ALIGN="BOTTOM" BORDER="0"
 SRC="img482.png"
 ALT="$m \tau$">, where
<IMG
 WIDTH="12" HEIGHT="14" ALIGN="BOTTOM" BORDER="0"
 SRC="img58.png"
 ALT="$k$"> and <IMG
 WIDTH="17" HEIGHT="13" ALIGN="BOTTOM" BORDER="0"
 SRC="img111.png"
 ALT="$m$"> are relatively prime, they both repeat after a time interval of
<IMG
 WIDTH="35" HEIGHT="14" ALIGN="BOTTOM" BORDER="0"
 SRC="img483.png"
 ALT="$km\tau$">. In other words, if the two have frequencies which are both multiples
of some common frequency, so that <!-- MATH
 $\omega_m=k\omega$
 -->
<IMG
 WIDTH="65" HEIGHT="30" ALIGN="MIDDLE" BORDER="0"
 SRC="img484.png"
 ALT="$\omega_m=k\omega$"> and <!-- MATH
 $\omega_c=m\omega$
 -->
<IMG
 WIDTH="65" HEIGHT="29" ALIGN="MIDDLE" BORDER="0"
 SRC="img485.png"
 ALT="$\omega_c=m\omega$">,
again with <IMG
 WIDTH="12" HEIGHT="14" ALIGN="BOTTOM" BORDER="0"
 SRC="img58.png"
 ALT="$k$"> and <IMG
 WIDTH="17" HEIGHT="13" ALIGN="BOTTOM" BORDER="0"
 SRC="img111.png"
 ALT="$m$"> relatively prime, the result will repeat at a frequency
of the common submultiple <IMG
 WIDTH="14" HEIGHT="13" ALIGN="BOTTOM" BORDER="0"
 SRC="img27.png"
 ALT="$\omega $">.  On the other hand, if no common
submultiple <IMG
 WIDTH="14" HEIGHT="13" ALIGN="BOTTOM" BORDER="0"
 SRC="img27.png"
 ALT="$\omega $"> can be found, or if the only submultiples are lower than
any discernible pitch,  then the result will be inharmonic.

<P>
Much more about FM can be found in textbooks [<A
 HREF="node202.html#r-moore90">Moo90</A>, p. 316]
[<A
 HREF="node202.html#r-dodge85">DJ85</A>, pp.115-139] [<A
 HREF="node202.html#r-boulanger00">Bou00</A>] and the research literature.
Some of the
possibilities are shown in the following examples.

<P>
<HR>
<!--Navigation Panel-->
<A NAME="tex2html1725"
  HREF="node80.html">
<IMG WIDTH="37" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="next"
 SRC="file:/usr/local/share/lib/latex2html/icons/next.png"></A> 
<A NAME="tex2html1719"
  HREF="node75.html">
<IMG WIDTH="26" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="up"
 SRC="file:/usr/local/share/lib/latex2html/icons/up.png"></A> 
<A NAME="tex2html1713"
  HREF="node78.html">
<IMG WIDTH="63" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="previous"
 SRC="file:/usr/local/share/lib/latex2html/icons/prev.png"></A> 
<A NAME="tex2html1721"
  HREF="node4.html">
<IMG WIDTH="65" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="contents"
 SRC="file:/usr/local/share/lib/latex2html/icons/contents.png"></A> 
<A NAME="tex2html1723"
  HREF="node201.html">
<IMG WIDTH="43" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="index"
 SRC="file:/usr/local/share/lib/latex2html/icons/index.png"></A> 
<BR>
<B> Next:</B> <A NAME="tex2html1726"
  HREF="node80.html">Examples</A>
<B> Up:</B> <A NAME="tex2html1720"
  HREF="node75.html">Modulation</A>
<B> Previous:</B> <A NAME="tex2html1714"
  HREF="node78.html">Waveshaping</A>
 &nbsp; <B>  <A NAME="tex2html1722"
  HREF="node4.html">Contents</A></B> 
 &nbsp; <B>  <A NAME="tex2html1724"
  HREF="node201.html">Index</A></B> 
<!--End of Navigation Panel-->
<ADDRESS>
Miller Puckette
2006-12-30
</ADDRESS>
</BODY>
</HTML>
